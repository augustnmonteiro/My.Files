#!/bin/bash

# Some function to boost productivity

#startLiveAPI/1
function liveStartAPI(){
  server=$1
  if [ "$server" = "" ]; then
    information "How you not defined server we are use 'beta'"
    server="beta"
  fi
  currentPWD=`pwd`
  goliveAlone
  information "Stop all node process"
  killall node
  information "Starting API In ($server)"
  export LIVE_API_RUNNING=$server
  nohup node server.js $server &
  export LIVE_API_RUNNING_PID=$!
  cd $currentPWD
  sleep 2
  openInChrome "http://localhost:3000/index"
}

function liveWhichApi(){
  if kill -0 $LIVE_API_RUNNING_PID ; then
    information "API Running In ($LIVE_API_RUNNING) Which ($LIVE_API_RUNNING_PID) PID"
  else
    error "API is down ($LIVE_API_RUNNING)"
  fi
}

function liveRestartApi(){
  information "API Running In ($LIVE_API_RUNNING)"
  liveStartAPI $LIVE_API_RUNNING
}

#startLiveAPIDev/1
function liveStartAPIDev(){
  liveStartAPI dev$1
}

# jiraOpen/0
function jiraOpen(){
    task=$1

    if [ "$task" = "" ]; then
        fb=$(git branch | sed -n -e 's/^\* \(.*\)/\1/p') 
        name=$(sed "s/feature\///g" <<< "$fb")
        task=$(sed "s/hotfix\///g" <<< "$name")
    fi

    openInChrome "https://jira.greenmile.com/browse/$task"
}
